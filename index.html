<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>配達ドリルトラッカー</title>
<style>
:root{
  --bg:#050816;--card:#141a2b;--text:#f5f5f5;--muted:#9ca3af;
  --b1:rgba(148,163,184,.16);--b2:rgba(148,163,184,.18);
  --glow:rgba(59,130,246,.35);
}
*{box-sizing:border-box}
body{
  margin:0;padding:10px;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:radial-gradient(circle at top,#182848 0,#050816 55%,#02030a 100%);
  color:var(--text);
}
h1{font-size:20px;margin:0 0 4px}
.sub{font-size:11px;color:var(--muted);margin:0 0 8px}
.card{
  background:linear-gradient(135deg,rgba(20,26,43,.95),rgba(9,12,24,.98));
  border-radius:14px;padding:10px;margin-bottom:10px;
  border:1px solid rgba(59,169,255,.10);
  box-shadow:0 18px 35px rgba(0,0,0,.8);
  position:relative;overflow:hidden;
}
.card.sparkle::before,.card.sparkle::after{
  content:"";position:absolute;inset:-40%;
  background:
    radial-gradient(circle at 20% 30%,rgba(59,169,255,.12),transparent 55%),
    radial-gradient(circle at 70% 60%,rgba(168,85,247,.10),transparent 55%);
  filter:blur(20px);pointer-events:none;opacity:.7;
  animation:spark 6.2s ease-in-out infinite alternate;
}
.card.sparkle::after{opacity:.45;transform:rotate(-8deg);animation-duration:4.6s}
@keyframes spark{from{transform:translate3d(-8%,-6%,0) rotate(10deg)}to{transform:translate3d(8%,6%,0) rotate(10deg)}}
.goal-met{border-color:rgba(250,204,21,.75)!important;box-shadow:0 0 0 1px rgba(250,204,21,.12),0 18px 35px rgba(0,0,0,.8)!important}
.row{display:grid;grid-template-columns:1fr 1fr;gap:6px}
.dash{
  background:rgba(2,6,23,.18);
  border:1px solid var(--b1);
  border-radius:12px;padding:10px;
}
.label{font-size:11px;color:var(--muted)}
.dash-value{font-size:22px;font-weight:800;margin-top:2px}
.input-row{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-top:6px}
input[type="text"],textarea{
  width:100%;border-radius:12px;border:1px solid var(--b2);
  background:rgba(2,6,23,.25);color:var(--text);
  padding:10px;font-size:16px;outline:none;
}
textarea{min-height:60px;resize:vertical}
button{
  border:none;border-radius:999px;padding:10px;font-weight:900;cursor:pointer;
  color:#fff;background:linear-gradient(90deg,#3b82f6,#06b6d4);
  box-shadow:0 10px 22px var(--glow);font-size:13px;
}
button:active{transform:translateY(1px)}
.btn-muted{
  background:rgba(148,163,184,.16);
  box-shadow:none;border:1px solid rgba(148,163,184,.18);
  color:rgba(226,232,240,.95);
}
.btn-goal{background:linear-gradient(90deg,#a855f7,#3b82f6);box-shadow:0 8px 18px rgba(168,85,247,.38)}
.btn-quest{background:linear-gradient(90deg,#3b82f6,#06b6d4);box-shadow:0 8px 18px rgba(59,130,246,.55)}
.btn-cash{background:linear-gradient(90deg,#f97316,#facc15);box-shadow:0 8px 18px rgba(249,115,22,.55)}
.btn-row{display:flex;gap:8px;margin-top:6px;justify-content:center}
.btn-row button{flex:1;width:auto;text-align:center}
.center-title{text-align:center;font-weight:950;letter-spacing:.02em;margin-bottom:6px}
.top-row{
  padding:8px 10px;border-radius:12px;
  background:radial-gradient(circle at top,#3b82f6 0,#020617 55%);
  border:1px solid rgba(59,130,246,.5);text-align:center;
}
.top-row .label{font-size:12px;color:#e5e7eb}
.top-row .value{font-size:26px;font-weight:900;margin-top:2px;text-shadow:0 10px 22px rgba(0,0,0,.5)}
.triple{display:flex;gap:6px;margin-top:6px}
.triple>div,.double>div{
  flex:1;min-width:0;
  background:rgba(2,6,23,.18);
  border:1px solid var(--b1);
  border-radius:12px;padding:10px;
}
.k{font-size:11px;color:rgba(156,163,175,.95)}
.v{font-size:18px;font-weight:950;margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.double{display:flex;gap:6px;margin-top:6px}
.double .v{font-size:16px}
.ach{
  display:flex;align-items:center;gap:10px;justify-content:space-between;
  margin-top:6px;background:rgba(2,6,23,.18);
  border:1px solid var(--b1);border-radius:12px;padding:10px;
}
.achL,.achR{font-size:12px;font-weight:950;white-space:nowrap}
.achBar{flex:1;height:10px;border-radius:999px;background:rgba(148,163,184,.14);overflow:hidden}
.achFill{height:100%;width:0%;background:linear-gradient(90deg,#22c55e,#facc15);border-radius:999px}
.runlist{margin-top:8px;display:none}
.runitem{
  background:rgba(2,6,23,.18);border:1px solid var(--b1);
  border-radius:12px;padding:10px;margin-bottom:8px;font-size:15px;
}
.runitem .small{font-size:12px;color:rgba(156,163,175,.95);margin-top:4px}
.toast{
  position:fixed;left:12px;bottom:12px;width:calc(100% - 24px);
  background:rgba(15,23,42,.92);
  border:1px solid rgba(59,130,246,.45);
  border-radius:14px;padding:12px;
  font-weight:950;font-size:14px;line-height:1.35;
  box-shadow:0 18px 40px rgba(0,0,0,.75);
  opacity:0;transform:translateY(12px);transition:.18s ease;
  pointer-events:none;max-height:30vh;overflow:auto;
}
.toast.show{opacity:1;transform:translateY(0)}
.calBtn{
  margin:8px auto 0;width:min(320px,100%);
  padding:10px 12px;border-radius:999px;
  border:1px solid rgba(148,163,184,.22);
  background:rgba(15,23,42,.6);font-weight:950;
  display:flex;align-items:center;justify-content:center;
  color:rgba(226,232,240,.95);
}
#calendarWrap{display:none;margin-top:10px}
.calList{display:flex;flex-direction:column;gap:6px}
.calDay{
  border-radius:12px;padding:10px;
  background:rgba(2,6,23,.20);
  border:1px solid rgba(148,163,184,.18);
}
.calHead{display:flex;align-items:center;justify-content:space-between;gap:10px;cursor:pointer}
.calDate{font-weight:950}
.calMetrics{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end;text-align:right}
.calMetrics span{font-size:12px;color:rgba(226,232,240,.88)}
.calDetails{margin-top:6px;display:none}
.calDay.open .calDetails{display:block}
.calRuns{margin-top:8px;display:none}
.calDay.showruns .calRuns{display:block}
</style>
</head>
<body>

<h1>配達ドリルトラッカー</h1>
<div class="sub">午前4時で日付が切り替わる（Uberの締めに合わせる）。金額・時間・件数は手打ち。</div>

<div class="card sparkle" id="topSummaryCard">
  <div class="row">
    <div class="dash"><div class="label">クエスト合計</div><div class="dash-value">¥<span id="questSum">0</span></div></div>
    <div class="dash"><div class="label">現金回収合計</div><div class="dash-value">¥<span id="cashSum">0</span></div></div>
    <div class="dash"><div class="label">目標回数</div><div class="dash-value"><span id="targetRunsLabel">なし</span></div></div>
    <div class="dash"><div class="label">目標金額</div><div class="dash-value"><span id="targetAmountLabel">なし</span></div></div>
  </div>

  <div class="input-row">
    <div><div class="label">目標回数（任意）</div><input type="text" inputmode="numeric" pattern="[0-9]*" id="inputTargetRuns" placeholder="未設定でもOK" /></div>
    <div><div class="label">目標金額（任意・円）</div><input type="text" inputmode="numeric" pattern="[0-9]*" id="inputTargetAmount" placeholder="未設定でもOK" /></div>
  </div>

  <div class="btn-row">
    <button class="btn-muted" onclick="resetGoal()">目標リセット</button>
    <button class="btn-goal" onclick="setGoal()">目標設定</button>
  </div>
</div>

<div class="card sparkle" id="mainStatsCard">
  <div class="top-row">
    <div class="label">総売上（クエスト込み）</div>
    <div class="value">¥<span id="totalSales">0</span></div>
  </div>

  <div class="ach" id="achRow" style="display:none;">
    <div class="achL">達成率</div>
    <div class="achBar"><div class="achFill" id="achFill"></div></div>
    <div class="achR" id="achText">0%</div>
  </div>

  <div class="triple">
    <div><div class="k">配達回数</div><div class="v"><span id="runCount">0</span>回</div></div>
    <div><div class="k">オンライン時間</div><div class="v"><span id="onlineTime">00:00</span></div></div>
    <div><div class="k">実働時間</div><div class="v"><span id="workTime">00:00</span></div></div>
  </div>

  <div class="double">
    <div><div class="k">オンライン時給換算</div><div class="v">¥<span id="onlineWage">0</span>/h</div></div>
    <div><div class="k">実働時給換算</div><div class="v">¥<span id="workWage">0</span>/h</div></div>
  </div>
</div>

<div class="card">
  <div class="center-title" style="font-size:16px;">配達案件</div>
  <div class="row">
    <div><div class="label">時間（分）</div><input type="text" inputmode="numeric" pattern="[0-9]*" id="inputMinutes" placeholder="例: 28" /></div>
    <div><div class="label">金額（円）</div><input type="text" inputmode="numeric" pattern="[0-9]*" id="inputAmount" placeholder="例: 1320" /></div>
    <div><div class="label">現金回収（円）</div><input type="text" inputmode="numeric" pattern="[0-9]*" id="inputCashCollected" placeholder="例: 300" /></div>
    <div><div class="label">件数（件）</div><input type="text" inputmode="numeric" pattern="[0-9]*" id="inputCount" placeholder="1" value="1" /></div>
  </div>
  <div class="btn-row">
    <button class="btn-muted" onclick="toggleRunList()">配達済み案件</button>
    <button onclick="addRun()">追加</button>
  </div>
  <div id="runList" class="runlist"></div>
</div>

<div class="card" id="calendarCard">
  <div class="center-title" id="calendarTitle" style="font-size:16px;cursor:pointer;">売上カレンダー</div>
  <button type="button" id="calendarToggle" class="calBtn">表示する</button>
  <div id="calendarWrap">
    <div class="sub" style="margin:0 0 6px;">日別：総売上 / 件数 / オンライン時給 / 実働時給</div>
    <div id="calendarList" class="calList"></div>
  </div>
</div>

<div class="card">
  <div class="center-title" style="font-size:16px;">クエスト & 今日のメモ & 現金チップ</div>
  <div class="row" style="margin-top:6px;">
    <div><div class="label">クエスト金額（円）</div><input type="text" inputmode="numeric" pattern="[0-9]*" id="inputQuest" placeholder="例: 1200" /></div>
    <div><div class="label">現金チップ（円）</div><input type="text" inputmode="numeric" pattern="[0-9]*" id="inputCashTip" placeholder="例: 300" /></div>
  </div>
  <div style="margin-top:6px;">
    <div class="label">今日のメモ</div>
    <textarea id="inputMemo" placeholder="メモ"></textarea>
  </div>
  <div class="btn-row">
    <button class="btn-quest" onclick="addQuest()">クエスト追加</button>
    <button class="btn-cash" onclick="addCashTip()">現金チップ</button>
  </div>
</div>

<div class="card">
  <div class="center-title" style="font-size:16px;">オンライン</div>
  <div class="btn-row">
    <button type="button" id="btnOnline">オンライン</button>
    <button type="button" id="btnOffline" class="btn-muted">オフライン</button>
  </div>
  <div class="sub" id="onlineState" style="margin:6px 0 0;text-align:center;display:none;">オンライン中</div>
</div>

<div id="toast" class="toast"></div>

<script>
const el=(id)=>document.getElementById(id);
const toInt=(s)=>{if(s==null)return 0;const n=parseInt(String(s).replace(/[^\d-]/g,""),10);return Number.isFinite(n)?n:0;};
const fmtYen=(n)=>String(Math.max(0,Math.round(n))).replace(/\B(?=(\d{3})+(?!\d))/g,",");

function businessDayKey(ts=Date.now()){
  const d=new Date(ts);d.setMinutes(d.getMinutes()-240);
  const y=d.getFullYear(),m=String(d.getMonth()+1).padStart(2,"0"),day=String(d.getDate()).padStart(2,"0");
  return `${y}-${m}-${day}`;
}
function businessWindow(dayKey){
  const [y,m,d]=dayKey.split("-").map(Number);
  const start=new Date(y,m-1,d,4,0,0,0).getTime();
  return {start,end:start+86400000};
}

const STORE_KEY="ddt_store_v11_compact";
const defaultState={
  runsLog:[],quest:[],cashTip:[],memo:"",
  calendarOpen:false,
  goal:{runs:0,amount:0},
  online:{isOn:false,startAt:0,accumulatedMs:0}
};
function structuredClonePoly(obj){ return JSON.parse(JSON.stringify(obj)); }
function loadState(){
  try{
    const raw=localStorage.getItem(STORE_KEY);
    if(!raw) return structuredClonePoly(defaultState);
    const s=JSON.parse(raw);
    const base=structuredClonePoly(defaultState);
    return Object.assign(base,s);
  }catch(e){return structuredClonePoly(defaultState);}
}
function saveState(){localStorage.setItem(STORE_KEY,JSON.stringify(state));}
let state=loadState();

let toastTimer=null;
function showToast(msg){
  const t=el("toast");t.textContent=msg;t.classList.add("show");
  clearTimeout(toastTimer);toastTimer=setTimeout(()=>t.classList.remove("show"),5000);
}

function todayKey(){return businessDayKey(Date.now());}
function totalsForDay(dayKey){
  const {start,end}=businessWindow(dayKey);
  const runs=state.runsLog.filter(r=>r.ts>=start&&r.ts<end);
  const quest=state.quest.filter(q=>q.ts>=start&&q.ts<end);
  const amountSum=runs.reduce((a,r)=>a+(r.amount||0),0);
  const questSum=quest.reduce((a,q)=>a+(q.amount||0),0);
  const sales=amountSum+questSum; // 総売上＝配達＋クエスト（現金チップは含めない）
  const count=runs.reduce((a,r)=>a+(r.count||0),0);
  const workMinutes=runs.reduce((a,r)=>a+(r.minutes||0),0);
  return {sales,count,workMs:workMinutes*60000};
}

function currentOnlineMs(){
  const o=state.online;
  let ms=o.accumulatedMs||0;
  if(o.isOn&&o.startAt)ms+=Date.now()-o.startAt;
  return Math.max(0,ms);
}
function fmtHHMM(ms){
  const totalMin=Math.floor(ms/60000);
  const hh=String(Math.floor(totalMin/60)).padStart(2,"0");
  const mm=String(totalMin%60).padStart(2,"0");
  return `${hh}:${mm}`;
}

let runListOpen=false;
function toggleRunList(){
  runListOpen=!runListOpen;
  el("runList").style.display=runListOpen?"block":"none";
  if(runListOpen)renderRunList();
}
function renderRunList(){
  const box=el("runList");
  const {start,end}=businessWindow(todayKey());
  const runs=state.runsLog.filter(r=>r.ts>=start&&r.ts<end).slice().reverse();
  if(!runs.length){box.innerHTML=`<div class="sub" style="margin:6px 0 0;">まだなし</div>`;return;}
  box.innerHTML=runs.map(r=>{
    const wage=r.minutes>0?Math.floor(r.amount/(r.minutes/60)):0;
    return `<div class="runitem">
      <div><strong>¥${fmtYen(r.amount)}</strong> / ${r.minutes}分 / ${r.count||1}件</div>
      <div class="small">時給換算：¥${fmtYen(wage)}/h　現金回収：¥${fmtYen(r.cashCollected||0)}</div>
    </div>`;
  }).join("");
}

function addRun(){
  const minutes=toInt(el("inputMinutes").value);
  const amount=toInt(el("inputAmount").value);
  const cashCollected=toInt(el("inputCashCollected").value);
  const count=Math.max(1,toInt(el("inputCount").value)||1);
  if(!minutes||!amount){showToast("時間（分）と金額（円）を入力してね");return;}
  const id=(crypto.randomUUID?crypto.randomUUID():String(Date.now())+Math.random());
  state.runsLog.push({id,ts:Date.now(),minutes,amount,cashCollected,count});
  el("inputMinutes").value="";el("inputAmount").value="";el("inputCashCollected").value="";el("inputCount").value="1";
  showToast(`追加：${minutes}分 / ¥${fmtYen(amount)} / ${count}件`);
  updateUI();
}

function addQuest(){
  const a=toInt(el("inputQuest").value);
  if(!a){showToast("クエスト金額を入れてね");return;}
  const id=(crypto.randomUUID?crypto.randomUUID():String(Date.now())+Math.random());
  state.quest.push({id,ts:Date.now(),amount:a});
  el("inputQuest").value="";
  showToast(`クエスト追加：¥${fmtYen(a)}`);
  updateUI();
}
function addCashTip(){
  const a=toInt(el("inputCashTip").value);
  if(!a){showToast("現金チップ金額を入れてね");return;}
  const id=(crypto.randomUUID?crypto.randomUUID():String(Date.now())+Math.random());
  state.cashTip.push({id,ts:Date.now(),amount:a});
  el("inputCashTip").value="";
  showToast(`現金チップ：¥${fmtYen(a)}（※総売上に入れない）`);
  updateUI();
}

el("inputMemo").value=state.memo||"";
el("inputMemo").addEventListener("input",()=>{state.memo=el("inputMemo").value||"";saveState();});

function setGoal(){
  state.goal.runs=toInt(el("inputTargetRuns").value);
  state.goal.amount=toInt(el("inputTargetAmount").value);
  showToast("目標を設定した");
  updateUI();
}
function resetGoal(){
  state.goal={runs:0,amount:0};
  el("inputTargetRuns").value="";el("inputTargetAmount").value="";
  showToast("目標をリセットした");
  updateUI();
}

function setOnline(on){
  const o=state.online;
  if(on){
    if(!o.isOn){o.isOn=true;o.startAt=Date.now();}
    el("btnOnline").classList.remove("btn-muted");
    el("btnOffline").classList.add("btn-muted");
  }else{
    if(o.isOn){
      o.accumulatedMs=(o.accumulatedMs||0)+(Date.now()-(o.startAt||Date.now()));
      o.startAt=0;o.isOn=false;
    }
    el("btnOnline").classList.add("btn-muted");
    el("btnOffline").classList.remove("btn-muted");
  }
  updateUI();
}
el("btnOnline").addEventListener("click",()=>setOnline(true));
el("btnOffline").addEventListener("click",()=>setOnline(false));

let calendarOpen=!!state.calendarOpen;
function setCalendarOpen(v){
  calendarOpen=!!v;
  state.calendarOpen=calendarOpen;
  saveState();
  el("calendarWrap").style.display=calendarOpen?"block":"none";
  el("calendarToggle").textContent=calendarOpen?"閉じる":"表示する";
  if(calendarOpen)renderCalendar();
}
el("calendarTitle").addEventListener("click",()=>setCalendarOpen(!calendarOpen));
el("calendarToggle").addEventListener("click",()=>setCalendarOpen(!calendarOpen));
setCalendarOpen(calendarOpen);

function renderCalendar(){
  const box=el("calendarList");
  const days=[],now=Date.now();
  for(let i=0;i<31;i++){
    const key=businessDayKey(now-i*86400000);
    if(!days.includes(key))days.push(key);
  }
  box.innerHTML=days.map(k=>{
    const t=totalsForDay(k);
    const onlineH=(k===todayKey())?(currentOnlineMs()/3600000):0;
    const onlineW=onlineH>0?Math.floor(t.sales/onlineH):0;
    const workH=(t.workMs||0)/3600000;
    const workW=workH>0?Math.floor(t.sales/workH):0;
    return `<div class="calDay" data-day="${k}">
      <div class="calHead">
        <div class="calDate">${k}</div>
        <div class="calMetrics">
          <span>売上: ¥${fmtYen(t.sales)}</span>
          <span>件数: ${fmtYen(t.count)}回</span>
          <span>オンライン: ¥${fmtYen(onlineW)}/h</span>
          <span>実働: ¥${fmtYen(workW)}/h</span>
        </div>
      </div>
      <div class="calDetails">
        <button type="button" class="calBtn" data-openruns="1">配達ログ（さらに開く）</button>
        <div class="calRuns"></div>
      </div>
    </div>`;
  }).join("");

  box.querySelectorAll(".calDay").forEach(dayEl=>{
    const head=dayEl.querySelector(".calHead");
    const btn=dayEl.querySelector('[data-openruns="1"]');
    const runsBox=dayEl.querySelector(".calRuns");
    const dayKey=dayEl.getAttribute("data-day");

    head.addEventListener("click",()=>dayEl.classList.toggle("open"));

    btn.addEventListener("click",(ev)=>{
      ev.stopPropagation();
      const open=dayEl.classList.toggle("showruns");
      if(open){
        const {start,end}=businessWindow(dayKey);
        const runs=state.runsLog.filter(r=>r.ts>=start&&r.ts<end).slice().reverse();
        if(!runs.length){
          runsBox.innerHTML=`<div class="sub" style="margin:6px 0 0;">その日の配達ログなし</div>`;
        }else{
          runsBox.innerHTML=runs.map(r=>{
            const wage=r.minutes>0?Math.floor(r.amount/(r.minutes/60)):0;
            return `<div class="runitem" style="margin-top:8px;">
              <div><strong>¥${fmtYen(r.amount)}</strong> / ${r.minutes}分 / ${r.count||1}件</div>
              <div class="small">時給換算：¥${fmtYen(wage)}/h　現金回収：¥${fmtYen(r.cashCollected||0)}</div>
            </div>`;
          }).join("");
        }
        btn.textContent="閉じる";
      }else{
        btn.textContent="配達ログ（さらに開く）";
      }
    });
  });
}

function updateUI(){
  const dayKey=todayKey();
  const {sales,count,workMs}=totalsForDay(dayKey);
  const {start,end}=businessWindow(dayKey);

  const questSum=state.quest.filter(q=>q.ts>=start&&q.ts<end).reduce((a,q)=>a+(q.amount||0),0);
  const cashSum=state.runsLog.filter(r=>r.ts>=start&&r.ts<end).reduce((a,r)=>a+(r.cashCollected||0),0);

  el("questSum").textContent=fmtYen(questSum);
  el("cashSum").textContent=fmtYen(cashSum);

  const gRuns=toInt(state.goal?.runs||0);
  const gAmt=toInt(state.goal?.amount||0);
  el("targetRunsLabel").textContent=gRuns>0?`${gRuns}回`:"なし";
  el("targetAmountLabel").textContent=gAmt>0?`¥${fmtYen(gAmt)}`:"なし";

  el("totalSales").textContent=fmtYen(sales);
  el("runCount").textContent=fmtYen(count);

  const onlineMs=currentOnlineMs();
  el("onlineTime").textContent=fmtHHMM(onlineMs);
  el("workTime").textContent=fmtHHMM(workMs);

  const onlineH=onlineMs/3600000,workH=workMs/3600000;
  el("onlineWage").textContent=fmtYen(onlineH>0?Math.floor(sales/onlineH):0);
  el("workWage").textContent=fmtYen(workH>0?Math.floor(sales/workH):0);

  let ach=0;
  if(gAmt>0) ach=Math.min(100,Math.floor((sales/gAmt)*100));
  else if(gRuns>0) ach=Math.min(100,Math.floor((count/gRuns)*100));

  if(gAmt>0||gRuns>0){
    el("achRow").style.display="flex";
    el("achFill").style.width=`${ach}%`;
    el("achText").textContent=`${ach}%`;
  }else{
    el("achRow").style.display="none";
  }

  const met=(gAmt>0&&sales>=gAmt)||(gRuns>0&&count>=gRuns);
  el("mainStatsCard").classList.toggle("goal-met",met);

  el("onlineState").style.display=state.online.isOn?"block":"none";

  if(runListOpen) renderRunList();

  saveState();
}

if(state.online.isOn){
  el("btnOnline").classList.remove("btn-muted");
  el("btnOffline").classList.add("btn-muted");
}else{
  el("btnOnline").classList.add("btn-muted");
  el("btnOffline").classList.remove("btn-muted");
}
setInterval(()=>updateUI(),1000);
updateUI();
</script>

</body>
</html>