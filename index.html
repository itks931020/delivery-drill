<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>配達ドリル</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background: #f0f0f0; }
        .class { background: white; margin: 10px 0; padding: 15px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .class h3 { margin: 0 0 10px; color: #333; }
        .label { font-weight: bold; color: #666; }
        .count { font-size: 2em; color: gold; font-weight: bold; }
        button { background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 1.2em; }
        button:hover { background: #45a049; }
        .total { background: #2196F3; color: white; padding: 20px; border-radius: 10px; text-align: center; margin: 20px 0; }
        .target { font-size: 1.5em; }
        .notes { background: #FFEB3B; padding: 15px; border-radius: 10px; margin: 20px 0; }
        input { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        .cash-total { background: #FF5722; color: white; font-size: 1.5em; font-weight: bold; padding: 10px; border-radius: 5px; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>配達ドリル (12-13時間目標)</h1>
    
    <div class="total">
        <div>合計配送: <span id="totalCount">0</span></div>
        <div class="target">目標: 12-13時間 (¥1500×2 + ¥1000×6 + ¥600×残りで調整)</div>
        <div>総額: <span id="totalAmount">¥0</span></div>
    </div>

    <div class="class">
        <h3>¥1500 (40分) <span id="count1500">0</span></h3>
        <button onclick="increment('1500')">+1 (40分)</button>
    </div>

    <div class="class">
        <h3>¥1000 (30分) <span id="count1000">0</span></h3>
        <button onclick="increment('1000')">+1 (30分)</button>
    </div>

    <div class="class">
        <h3>¥600 (20分) <span id="count600">0</span></h3>
        <button onclick="increment('600')">+1 (20分)</button>
    </div>

    <div class="notes">
        <h3>クエスト & 今日のメモ & 現金回収</h3>
        <label>クエスト金額: <input type="number" id="questAmount" placeholder="例: 2000" min="0"></label>
        <label>現金回収: <input type="number" id="cashAmount" placeholder="例: 500" min="0"></label>
        <div id="notesTotal" class="cash-total">追加合計: ¥0</div>
    </div>

    <script>
        const classes = {
            1500: { price: 1500, time: 40, target: 2 },
            1000: { price: 1000, time: 30, target: 6 },
            600: { price: 600, time: 20, target: 0 } // 残りで自動調整
        };

        let counts = JSON.parse(localStorage.getItem('deliveryCounts')) || {1500: 0, 1000: 0, 600: 0};
        let quest = parseInt(localStorage.getItem('questAmount')) || 0;
        let cash = parseInt(localStorage.getItem('cashAmount')) || 0;

        function saveData() {
            localStorage.setItem('deliveryCounts', JSON.stringify(counts));
            localStorage.setItem('questAmount', quest);
            localStorage.setItem('cashAmount', cash);
        }

        function updateDisplay() {
            let totalCount = 0, totalAmount = 0;
            Object.keys(counts).forEach(key => {
                document.getElementById(`count${key}`).textContent = counts[key];
                totalCount += counts[key];
                totalAmount += counts[key] * classes[key].price;
            });
            document.getElementById('totalCount').textContent = totalCount;
            document.getElementById('totalAmount').textContent = `¥${totalAmount}`;

            quest = parseInt(document.getElementById('questAmount').value) || 0;
            cash = parseInt(document.getElementById('cashAmount').value) || 0;
            const notesTotal = quest + cash;
            document.getElementById('notesTotal').textContent = `追加合計: ¥${notesTotal}`;
            saveData();
        }

        function increment(cls) {
            counts[cls]++;
            // 金色ハイライト (一瞬)
            const span = document.getElementById(`count${cls}`);
            span.style.color = 'gold';
            setTimeout(() => span.style.color = 'gold', 200);
            updateDisplay();
        }

        // 目標600自動計算 (12時間=720分 or 13時間=780分)
        function calcTarget600() {
            const baseTime1500 = counts[1500] * 40;
            const baseTime1000 = counts[1000] * 30;
            const targetTime = 750; // 12.5時間平均
            const remainTime = targetTime - baseTime1500 - baseTime1000;
            classes[600].target = Math.max(0, Math.floor(remainTime / 20));
        }

        document.getElementById('questAmount').addEventListener('input', updateDisplay);
        document.getElementById('cashAmount').addEventListener('input', updateDisplay);

        updateDisplay();
        calcTarget600();
    </script>
</body>
</html>
